name: Sync with ameba-rtos-pro2

on:
  repository_dispatch:
    types: [push]

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4
      - name: Sync with ameba-rtos-pro2
      run: |
        git fetch https://${TARGET_REPO_PAT}@github.com/M-ichae-l/ameba-rtos-pro2.git
        git merge FETCH_HEAD
        git push origin main
        shell: /usr/bin/bash -e {0}
      env:
        TARGET_REPO_PAT: ${{ secrets.TARGET_REPO_PAT }}
